{% extends "layout.html" %}


{% block content %}
<div class="container mt-5 mb-5">

    <!-- HERO SECTION -->
    <div class="card card-dark card-static mb-5">
        <div class="card-body p-5">
            <div class="row align-items-center">
                
                <div class="col-lg-7">
                    <h1 class="dashboard-title mb-3">Welcome to ClassicModels</h1>
                    <p class="text-white-50 fs-5 mb-4">
                        Your one-stop shop for premium die-cast models and replicas.
                        From classic cars to vintage aircraft, explore our curated
                        collection of high-quality collectibles.
                    </p>

                    <div class="d-flex gap-3">
                        <a href="{{ url_for('productlines') }}" class="btn btn-primary btn-lg px-4">
                            Shop All Products
                        </a>
                        {% if not session.get('user_number') %}
                        <a href="{{ url_for('login') }}" class="btn btn-outline-light btn-lg px-4">
                            Login
                        </a>
                        {% endif %}
                    </div>
                </div>

                <div class="col-lg-5 text-center mt-4 mt-lg-0">
                    <div class="rounded-3 overflow-hidden border border-secondary">
                        <img
                            src="https://cdn.pixabay.com/photo/2015/05/30/21/43/capri-790722_1280.jpg"
                            alt="Classic Ford Capri"
                            class="img-fluid rounded-3"
                            loading="lazy"
                            referrerpolicy="no-referrer">
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- OFFICES HEADER -->
    <div class="d-flex justify-content-between align-items-center page-header mb-4">
        <h2 class="dashboard-title mb-0">Our Global Offices</h2>

        {% if session.get('job_title') == 'President' %}
        <a href="{{ url_for('add_office') }}" class="btn btn-success">
            <i class="bi bi-plus-circle me-1"></i> Add New Office
        </a>
        {% endif %}
    </div>

    <!-- OFFICES GRID -->
    <div class="row g-4">
        {% for office in offices %}
        <div class="col-md-6 col-lg-3">
            <div class="card card-dark h-100 office-card"
                 style="cursor: pointer;"
                 onclick="toggleOfficeDetails('{{ office.officeCode }}')">

                <div class="card-body text-center">
                    <h5 class="fw-bold text-white mb-1">{{ office.city }}</h5>
                    <div class="text-white-50 mb-3">{{ office.country }}</div>

                    {% if session.get('job_title') == 'President' %}
                    <span class="badge bg-secondary mb-3" style="color: #0e3a6d;">
                        Employees: {{ office.employee_count }}
                    </span>
                    {% endif %}

                    <div id="office-details-{{ office.officeCode }}"
                         class="mt-3 text-start border-top border-secondary pt-3"
                         style="display: none;">

                        <div class="small text-white-50 mb-2">
                            {{ office.addressLine1 }}<br>
                            {% if office.addressLine2 %}{{ office.addressLine2 }}<br>{% endif %}
                            {{ office.postalCode }}
                        </div>

                        <div class="small mb-3">
                            <i class="bi bi-telephone me-1"></i>
                            <a href="tel:{{ office.phone }}" class="text-decoration-none text-white">
                                {{ office.phone }}
                            </a>
                        </div>

                        {% if session.get('job_title') == 'President' %}
                        <div class="d-grid gap-2">
                            <a href="{{ url_for('edit_office', office_code=office.officeCode) }}"
                               class="btn btn-sm btn-outline-warning">
                                Edit
                            </a>

                            <form action="{{ url_for('delete_office_route', office_code=office.officeCode) }}"
                                  method="POST"
                                  onsubmit="return confirm('Delete {{ office.city }} office?');">
                                <button class="btn btn-sm btn-outline-danger w-100">
                                    Delete
                                </button>
                            </form>
                        </div>
                        {% endif %}
                    </div>
                </div>

            </div>
        </div>
        {% endfor %}
    </div>

</div>

<script>
function toggleOfficeDetails(code) {
    if (event.target.closest('a, button, form')) return;
    const el = document.getElementById('office-details-' + code);
    el.style.display = el.style.display === 'none' ? 'block' : 'none';
}
</script>
{% endblock %}