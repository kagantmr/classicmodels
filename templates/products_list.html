{% extends "layout.html" %}

{% block content %}

<h1 class="mb-4">Product Management</h1>

<div class="d-flex justify-content-between align-items-center mb-3">
  <p class="mb-0 text-muted">
    Manage products in the ClassicModels catalog.
  </p>

  <!-- Correct NEW PRODUCT button -->
  <a href="{{ url_for('create_product') }}" class="btn btn-primary">
    + Add New Product
  </a>
</div>

<table class="table table-striped table-hover table-sm">
  <thead>
    <tr>
      <th>Code</th>
      <th>Name</th>
      <th>Line</th>
      <th>Scale</th>
      <th>Vendor</th>
      <th class="text-end">In Stock</th>
      <th class="text-end">Buy Price</th>
      <th class="text-end">MSRP</th>
      <th class="text-end">Actions</th>
    </tr>
  </thead>

  <tbody>
    {% for p in products %}
    <tr>
      <td>{{ p.productCode }}</td>
      <td>{{ p.productName }}</td>
      <td>{{ p.productLine }}</td>
      <td>{{ p.productScale }}</td>
      <td>{{ p.productVendor }}</td>
      <td class="text-end">{{ p.quantityInStock }}</td>
      <td class="text-end">{{ "%.2f"|format(p.buyPrice) }}</td>
      <td class="text-end">{{ "%.2f"|format(p.MSRP) }}</td>

      <td class="text-end">
        <!-- Correct EDIT link -->
        <a href="{{ url_for('edit_product', product_code=p.productCode) }}"
           class="btn btn-sm btn-outline-secondary">
          Edit
        </a>

        <!-- Correct DELETE link -->
        <a href="{{ url_for('delete_product_route', product_code=p.productCode) }}"
           class="btn btn-sm btn-outline-danger">
          Delete
        </a>
      </td>
    </tr>
    {% else %}
    <tr>
      <td colspan="9" class="text-center text-muted">No products found.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}